\documentclass[a4paper,11pt]{article}

\usepackage[top=1in,bottom=1in,left=1in,right=1in]{geometry}
\usepackage{amsmath,amssymb,amsfonts,amsthm}

\newtheorem{proposition}{Proposition}


\newcommand{\pr}{\mathrm{Pr}}
\newcommand{\tp}{\tilde{p}}

\newcommand{\rsp}{\mathbb{R}}
\newcommand{\unif}{\mathrm{Uniform}}


\begin{document}

\title{Appendix for Lecture 2: Monte Carlo Methods (Basics)}
\author{Dahua Lin}
\date{}
\maketitle

\section{Justification of Basic Sampling Methods}

\begin{proposition}
    Let $F$ be the cdf of a real-valued random variable with distribution $D$. Let $U \sim \unif([0, 1])$, then $F^{-1}(U) \sim D$.
\end{proposition}

\begin{proof}
    Let $X = F^{-1}(U)$. It suffices to show that the cdf of $X$ is $F$. For any $t \in \rsp$,
    \begin{equation}
        P(X \le t) = P(F^{-1}(U) \le t) = P(U \le F(t)) = F(t).
    \end{equation}
    Here, we utilize the fact that $F$ is non-decreasing. 
\end{proof}

\begin{proposition}
    Samples producted using Rejection sampling has the desired distribution.
\end{proposition}

\begin{proof}
    Each iteration actually generate two random variables: $x$ and $u$, where $u \in \{0, 1\}$ is the indicator of acceptance. 
    The join distribution of $x$ and $u$ is given by 
    \begin{equation}
        \tp(dx, u = 1) = a(u = 1 | x) q(dx) = \frac{p(x)}{M q(x)} q(x) dx = \frac{p(x)}{M} \mu(dx).
    \end{equation}
    Here, $a(u | x)$ is the conditional distribution of $u$ on $x$, and $\mu$ is the base measure. 
    On the other hand, we have
    \begin{equation}
        \pr(u = 1) = \int \tp(dx, u=1) = \int \frac{p(x)}{M} \mu(dx) = \frac{1}{M}.
    \end{equation}
    Thus, the resultant distribution is
    \begin{equation}
        \tp(dx | u = 1) = \frac{\tp(dx, u=1)}{\pr(u = 1)} = p(x) \mu(dx).
    \end{equation}
    This completes the proof.
\end{proof}








\end{document}
